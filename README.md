# Adaptive Emotional State Manager (MobileSensorApp)

[![Android CI](https://img.shields.io/badge/CI-GitHub%20Actions-blue)](#-ci)
[![Kotlin](https://img.shields.io/badge/Kotlin-1.9%2B-purple)](#-tech-stack)
[![Min SDK](https://img.shields.io/badge/minSdk-?\[—É–∫–∞–∂–∏\]-informational)](#-requirements)
[![Compose](https://img.shields.io/badge/Jetpack%20Compose-yes-success)](#-tech-stack)

Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è **—Å–±–æ—Ä–∞ —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∏ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø—É–ª—å—Å, —à–∞–≥–∏, —à—É–º, –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä) –∏ **–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è**. –î–∞–Ω–Ω—ã–µ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –∏ **–æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç** –≤ –±–µ–∫–µ–Ω–¥ (Firebase) —á–µ—Ä–µ–∑ **WorkManager**, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è **—Ä—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞**, **–æ—Ñ—Ñ–ª–∞–π–Ω-–∫—ç—à** –∏ **–ø–∞–Ω–µ–ª—å –∞–Ω–∞–ª–∏—Ç–∏–∫–∏** –Ω–∞ Jetpack Compose.

> –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Å–æ–±—Ä–∞—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø–æ–¥—Ö–æ–¥—ã –∫ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Å—Ç—Ä–µ—Å—Å–∞/–ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å –æ–ø–æ—Ä–æ–π –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä—ã.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* üì° **–°–±–æ—Ä —Å–µ–Ω—Å–æ—Ä–æ–≤**: –ø—É–ª—å—Å*, —à–∞–≥–∏, —É—Ä–æ–≤–µ–Ω—å —à—É–º–∞, –∞–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä
  (*–∏—Å—Ç–æ—á–Ω–∏–∫ –ø—É–ª—å—Å–∞: –≤–Ω–µ—à–Ω–µ–µ BLE/—É–º–Ω—ã–µ —á–∞—Å—ã –∏–ª–∏ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä ‚Äî —Å–º. –∫–æ–Ω—Ñ–∏–≥)
* üîÑ **–§–æ–Ω–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç** —á–µ—Ä–µ–∑ WorkManager (retry/backoff, merge)
* üì¥ **Offline-first**: –ª–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à (Room) + –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —Ç–æ–∫–µ–Ω—ã –≤ DataStore
* üìä **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞**: —ç–∫—Ä–∞–Ω –º–µ—Ç—Ä–∏–∫ –∏ –∏—Å—Ç–æ—Ä–∏—è –Ω–∞ Jetpack Compose (–≥—Ä–∞—Ñ–∏–∫–∏, —Å–ø–∏—Å–∫–∏)
* üß™ **–ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞**: Crashlytics/Analytics (crash-free %, –∞–Ω–æ–º–∞–ª–∏–∏ —Å–µ–Ω—Å–æ—Ä–æ–≤)
* üñ±Ô∏è **–†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞**: —Ñ–æ—Ä—Å-–±–∞—Ç—á –∏–∑ UI
* üîê **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å**: –º–∏–Ω–∏–º—É–º PII, –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã, opt-in

---

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

* **Kotlin**, **Jetpack Compose**, **Material 3**, **Navigation**
* **MVVM**, **Clean Architecture**, Repository, **Hilt (DI)**
* **Coroutines** / **Flow**
* **Room**, **DataStore (Preferences)**, **Paging 3**
* **Retrofit/OkHttp** (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–π REST)
* **WorkManager** (–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á)
* **Firebase**
* CI: **GitHub Actions**

---

## ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* **Android Studio** Giraffe/Koala –∏–ª–∏ –Ω–æ–≤–µ–µ
* **Kotlin** 1.9+
* **minSdk**: `24` ‚Ä¢ **targetSdk**: `35`
* –ê–∫–∫–∞—É–Ω—Ç **Firebase** + `google-services.json` –≤ `app/`

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å**

   ```bash
   git clone https://github.com/GogaTheCoder/MobileSensorApp.git
   cd MobileSensorApp
   ```
2. **–î–æ–±–∞–≤–∏—Ç—å Firebase –∫–æ–Ω—Ñ–∏–≥**

   * –°–∫–∞—á–∞–π `google-services.json` –∏–∑ Firebase Console –∏ –ø–æ–ª–æ–∂–∏ –≤ `app/`.
3. **–°–æ–±—Ä–∞—Ç—å**

   ```bash
   ./gradlew clean assembleDebug
   ```
4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å** –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ/—ç–º—É–ª—è—Ç–æ—Ä–µ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏:

   * `ACTIVITY_RECOGNITION` (—à–∞–≥–∏)
   * `BODY_SENSORS` / `BODY_SENSORS_BACKGROUND` (–ø—É–ª—å—Å ‚Äî –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
   * `RECORD_AUDIO` (—É—Ä–æ–≤–µ–Ω—å —à—É–º–∞)
   * `POST_NOTIFICATIONS` (–¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

> ‚ö†Ô∏è –ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö OEM (Xiaomi, Huawei –∏ –¥—Ä.) –≤—Ä—É—á–Ω—É—é **—Ä–∞–∑—Ä–µ—à–∏ —Ä–∞–±–æ—Ç—É –≤ —Ñ–æ–Ω–µ** –∏ **–æ—Ç–∫–ª—é—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –±–∞—Ç–∞—Ä–µ–∏** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã WorkManager.

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–ø—Ä–∏–º–µ—Ä)

```
app/
 ‚îú‚îÄ data/
 ‚îÇ   ‚îú‚îÄ local/ (Room: Dao, Entities, Database)
 ‚îÇ   ‚îú‚îÄ remote/ (Firebase / API)
 ‚îÇ   ‚îú‚îÄ repository/ (SensorRepository, UploadRepository)
 ‚îÇ   ‚îî‚îÄ prefs/ (DataStore)
 ‚îú‚îÄ domain/
 ‚îÇ   ‚îú‚îÄ model/ (SensorData, Batch, Metrics ...)
 ‚îÇ   ‚îî‚îÄ usecase/ (CollectSensorData, EnqueueUpload, ...)
 ‚îú‚îÄ ui/
 ‚îÇ   ‚îú‚îÄ screens/
 ‚îÇ   ‚îÇ   ‚îú‚îÄ dashboard/ (current values + charts)
 ‚îÇ   ‚îÇ   ‚îî‚îÄ history/ (list + details)
 ‚îÇ   ‚îú‚îÄ components/ (charts, cards)
 ‚îÇ   ‚îî‚îÄ theme/
 ‚îú‚îÄ workers/ (UploadWorker, MergeWorker, RetryPolicy)
 ‚îú‚îÄ di/ (Hilt modules)
 ‚îú‚îÄ utils/ (logging, permissions)
 ‚îî‚îÄ MainApplication.kt / MainActivity.kt
```

---

## üß≠ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```text
Sensors -> Collectors -> Repository -> (Room cache) -> WorkManager -> Uploader -> Firebase
                                  \-> Flow -> ViewModel -> Compose UI (Charts/History)
```

* **MVVM + Clean**: UI ‚Üî ViewModel (Flow/State), –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤ use-cases, –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ Repository.
* **Offline-first**: –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∫–µ—à–∏—Ä—É—é—Ç—Å—è –≤ Room; –æ—Ç–ø—Ä–∞–≤–∫–∞ ‚Äî –±–∞—Ç—á–∞–º–∏ —á–µ—Ä–µ–∑ WorkManager —Å backoff.
* **Observability**: Crashlytics –¥–ª—è –æ—à–∏–±–æ–∫, Analytics ‚Äî –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π –∏ –∞–Ω–æ–º–∞–ª–∏–π —Å–µ–Ω—Å–æ—Ä–æ–≤.

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

* **–ò–Ω—Ç–µ—Ä–≤–∞–ª —Ñ–æ–Ω–æ–≤–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏**: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 15 –º–∏–Ω—É—Ç (PeriodicWorkRequest)
* **–°–ª–∏—è–Ω–∏–µ –∑–∞–¥–∞—á**: unique work + `ExistingPeriodicWorkPolicy.KEEP`
* **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–µ—Ç–∏ / –Ω–µ –≤ —Ä–µ–∂–∏–º–µ low battery 

---

## üîç –î–∞–Ω–Ω—ã–µ/–°—Ö–µ–º–∞ (–ø—Ä–∏–º–µ—Ä)

```kotlin
data class SensorData(
    val ts: Long,              // timestamp
    val heartRate: Int?,       // bpm (nullable)
    val steps: Int?,           // delta steps
    val noiseDb: Float?,       // decibels
    val accel: Vec3?,          // x/y/z
    val battery: Int?,         // %
    val deviceId: String       // anonymized id
)
```

–ë–∞—Ç—á–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–ø–∏—Å–∫–∞–º–∏ `SensorData` –∑–∞ –ø–µ—Ä–∏–æ–¥. –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –Ω–µ —Ö—Ä–∞–Ω–∏–º PII –∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

---

## üñºÔ∏è –°–∫—Ä–∏–Ω—à–æ—Ç—ã

| Dashboard (—Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è)              | History (—Å–ø–∏—Å–∫–∏ + –¥–µ—Ç–∞–ª–∏)               | Charts (–≥—Ä–∞—Ñ–∏–∫–∏)                       |
| ----------------------------------------- | --------------------------------------- | -------------------------------------- |
| ![screen1](docs/img/screen_dashboard.png) | ![screen2](docs/img/screen_history.png) | ![screen3](docs/img/screen_charts.png) |

> –î–æ–±–∞–≤—å 2‚Äì3 PNG –≤ `docs/img/` –∏ –æ–±–Ω–æ–≤–∏ –ø—É—Ç–∏.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* **Unit**: ViewModel/use-cases ‚Äî **JUnit5**, **MockK**, —Ç–µ—Å—Ç—ã `Flow`
* **UI**: –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã Compose (–ø–æ –∫–ª—é—á–µ–≤—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º)
* **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ**: —Ç–µ—Å—Ç –≤–æ—Ä–∫–µ—Ä–æ–≤ WorkManager (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ó–∞–ø—É—Å–∫:

```bash
./gradlew test
```

---

## üîß CI

–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π GitHub Actions workflow: `/.github/workflows/android.yml`

```yaml
name: Android CI
on:
  push: { branches: ["main"] }
  pull_request: { branches: ["main"] }

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: "17"
      - name: Gradle cache
        uses: gradle/actions/setup-gradle@v3
      - name: Lint & Unit tests
        run: ./gradlew lintDebug test
      - name: Assemble Debug
        run: ./gradlew assembleDebug
```

> –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å `google-services.json`, –¥–ª—è PR –º–æ–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å —Å mock-–∫–æ–Ω—Ñ–∏–≥–æ–º (–∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —à–∞–≥ Firebase-–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á).

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–æ–ª—è –≤ README)

* **Crash-free sessions**: > **99%**
* **TTFB** –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏: ‚àí**25%** —Å –∫—ç—à–µ–º
* **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á**: ~**99%** —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
* **–ë–∞—Ç–∞—Ä–µ—è**: —Å—Ä–µ–¥–Ω–µ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –∑–∞ —Å—É—Ç–∫–∏ `[—É–∫–∞–∂–∏]`
* **–†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞/—Å—É—Ç–æ–∫**: `[N]` –∑–∞–ø–∏—Å–µ–π, `[M]` –±–∞—Ç—á–µ–π

---

## üîê –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å

* –ë–µ–∑ PII –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é; ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ‚Äî –∞–Ω–æ–Ω–∏–º–Ω—ã–π (UUID/DataStore)
* –ù–µ—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏, –µ—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ —è–≤–Ω–æ
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å **opt-out** –æ—Ç —Ñ–æ–Ω–æ–≤–æ–≥–æ —Å–±–æ—Ä–∞/–∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

---

## üó∫Ô∏è Roadmap

* [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (CSV/JSON)
* [ ] –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ —Å–µ–Ω—Å–æ—Ä–æ–≤ (Gyro/HRV)
* [ ] –ê–≤—Ç–æ-–¥–µ—Ç–µ–∫—Ü–∏—è —Å—Ç—Ä–µ—Å—Å–∞ (–æ–Ω-–¥–µ–≤–∞–π—Å –º–æ–¥–µ–ª—å / TF Lite)
* [ ] A/B –º–µ—Ç—Ä–∏–∫–∏ UI –ø–∞–Ω–µ–ª–∏
* [ ] –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è (ru/en)

---

## üß© FAQ

**–ü–æ—á–µ–º—É WorkManager –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –º–æ—ë–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ?**
‚Üí –ü—Ä–æ–≤–µ—Ä—å ¬´Battery optimization¬ª, ¬´Auto-start¬ª, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Ñ–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –∏ —Å–µ—Ç—å. –ù–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö OEM –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏—è.

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ–Ω—Å–æ—Ä?**
‚Üí –°–æ–∑–¥–∞–π `Collector` –≤ `data/...`, –æ–ø–∏—à–∏ –º–æ–¥–µ–ª—å –≤ `domain/model`, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ –¥–æ–±–∞–≤—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤ UI.

---

## ü§ù –í–∫–ª–∞–¥

PR –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è: –∑–∞–≤–µ–¥–∏—Ç–µ issue, –æ–ø–∏—à–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.
–î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∏—á ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π RFC –≤ issue.
